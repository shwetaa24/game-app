<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galactic Tic-Tac-Toe</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Set up custom font and configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#1e293b',
                        'secondary-dark': '#0f172a',
                        'accent-x': '#ef4444', // Red for X
                        'accent-o': '#3b82f6', // Blue for O
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom styles for the game board */
        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 8px;
            width: 100%;
            max-width: 400px; /* Limit board size on large screens */
            aspect-ratio: 1 / 1; /* Keep it square */
        }

        .cell {
            background-color: #334155; /* Slate-700 */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 4rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: 12px;
            transition: background-color 0.2s, transform 0.1s;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        
        /* Hover effect for empty cells */
        .cell:not(.x):not(.o):hover {
            background-color: #475569; /* Slate-600 */
            transform: scale(1.03);
        }

        /* Player X and O specific styles */
        .cell.x { color: var(--accent-x); }
        .cell.o { color: var(--accent-o); }
        
        /* Styles for the message modal */
        .modal {
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            transition: opacity 0.3s ease-in-out;
        }

    </style>
</head>
<body class="bg-secondary-dark min-h-screen flex items-center justify-center p-4 font-sans text-white">

    <!-- Game Container -->
    <div class="w-full max-w-lg mx-auto bg-primary-dark p-6 sm:p-8 rounded-2xl shadow-2xl space-y-6">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-center text-blue-300">Galactic Tic-Tac-Toe</h1>
        
        <!-- Status Display -->
        <div id="status" class="text-xl font-semibold text-center h-8">Player X's Turn</div>

        <!-- Game Board -->
        <div id="board" class="board mx-auto">
            <!-- Cells will be generated by JavaScript -->
        </div>

        <!-- Scoreboard and Reset Button -->
        <div class="flex flex-col sm:flex-row justify-between items-center pt-4 border-t border-gray-700">
            <div class="flex space-x-6 text-lg font-medium mb-4 sm:mb-0">
                <p>X Wins: <span id="x-score" class="text-accent-x">0</span></p>
                <p>O Wins: <span id="o-score" class="text-accent-o">0</span></p>
            </div>
            <button id="reset-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg transition duration-200 shadow-md transform hover:scale-105">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.603 3.04l-1.471.737A5.002 5.002 0 005.999 7H8a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm13 8a1 1 0 01-1 1h-2.101a7.002 7.002 0 01-11.603-3.04l1.471-.737A5.002 5.002 0 0014.001 13H12a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h2.101a7.002 7.002 0 01-11.603-3.04l-1.471.737A5.002 5.002 0 0017.001 9H18a1 1 0 01-1 1z" clip-rule="evenodd" />
                </svg>
                Reset Game
            </button>
        </div>
    </div>

    <!-- Message Modal (Hidden by default) -->
    <div id="modal" class="modal fixed inset-0 flex items-center justify-center z-50 opacity-0 pointer-events-none">
        <div class="bg-primary-dark p-8 rounded-xl shadow-2xl text-center transform scale-95 transition-transform duration-300">
            <h2 id="modal-message" class="text-3xl font-bold mb-4 text-yellow-400"></h2>
            <button id="modal-close-button" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg transition duration-200">
                Play Again
            </button>
        </div>
    </div>

    <script>
        const board = document.getElementById('board');
        const statusDisplay = document.getElementById('status');
        const resetButton = document.getElementById('reset-button');
        const modal = document.getElementById('modal');
        const modalMessage = document.getElementById('modal-message');
        const modalCloseButton = document.getElementById('modal-close-button');
        const xScoreDisplay = document.getElementById('x-score');
        const oScoreDisplay = document.getElementById('o-score');
        
        // Game state variables
        let cells = ['', '', '', '', '', '', '', '', ''];
        let currentPlayer = 'X';
        let gameActive = true;
        let scores = { 'X': 0, 'O': 0 };

        // Winning combinations (indices of the cells)
        const winningConditions = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8], // Rows
            [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columns
            [0, 4, 8], [2, 4, 6]             // Diagonals
        ];

        // --- Core Functions ---

        const updateStatus = () => {
            if (!gameActive) return;
            statusDisplay.textContent = `Player ${currentPlayer}'s Turn`;
            statusDisplay.className = `text-xl font-semibold text-center h-8 ${currentPlayer === 'X' ? 'text-accent-x' : 'text-accent-o'}`;
        };

        const updateScores = () => {
            xScoreDisplay.textContent = scores['X'];
            oScoreDisplay.textContent = scores['O'];
        }

        const handleResultValidation = () => {
            let roundWon = false;
            for (let i = 0; i < winningConditions.length; i++) {
                const winCondition = winningConditions[i];
                let a = cells[winCondition[0]];
                let b = cells[winCondition[1]];
                let c = cells[winCondition[2]];

                if (a === '' || b === '' || c === '') continue;

                if (a === b && b === c) {
                    roundWon = true;
                    // Highlight the winning cells
                    winCondition.forEach(index => {
                        document.getElementById(`cell-${index}`).style.backgroundColor = '#10b981'; // Emerald-500
                        document.getElementById(`cell-${index}`).style.transform = 'scale(1.1)';
                    });
                    break;
                }
            }

            if (roundWon) {
                gameActive = false;
                scores[currentPlayer]++;
                updateScores();
                showModal(`Player ${currentPlayer} Wins!`);
                return;
            }

            // Check for a Draw
            if (!cells.includes('')) {
                gameActive = false;
                showModal("It's a Draw!");
                return;
            }

            // Continue game: switch player
            currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
            updateStatus();
        };

        const handleCellClick = (clickedCell, clickedCellIndex) => {
            if (cells[clickedCellIndex] !== '' || !gameActive) return;

            // Update game state
            cells[clickedCellIndex] = currentPlayer;
            clickedCell.textContent = currentPlayer;
            clickedCell.classList.add(currentPlayer.toLowerCase());

            handleResultValidation();
        };
        
        const showModal = (message) => {
            modalMessage.textContent = message;
            // Use requestAnimationFrame to ensure visibility transition plays
            requestAnimationFrame(() => {
                modal.classList.remove('opacity-0', 'pointer-events-none');
                modal.querySelector('div').classList.remove('scale-95');
            });
        };

        const hideModal = () => {
            modal.querySelector('div').classList.add('scale-95');
            modal.classList.add('opacity-0', 'pointer-events-none');
        };

        const resetGame = (fullReset = false) => {
            hideModal();
            cells = ['', '', '', '', '', '', '', '', ''];
            currentPlayer = 'X';
            gameActive = true;
            
            if (fullReset) {
                scores = { 'X': 0, 'O': 0 };
                updateScores();
            }

            // Clear board visuals and reattach listeners
            board.innerHTML = '';
            initializeBoard();
            updateStatus();
        };

        const initializeBoard = () => {
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.id = `cell-${i}`;
                cell.addEventListener('click', () => handleCellClick(cell, i));
                board.appendChild(cell);
            }
        };

        // --- Event Listeners ---
        
        // Use the reset button for a full score reset
        resetButton.addEventListener('click', () => resetGame(true));
        
        // The modal button plays the next round without resetting the score
        modalCloseButton.addEventListener('click', () => resetGame(false));
        
        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initializeBoard();
            updateStatus();
            updateScores();
        });
        
    </script>
</body>
</html>